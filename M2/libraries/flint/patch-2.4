--- flint-2.4/configure	2014-01-17 17:50:39.000000000 +0100
+++ flint-2.4/configure	2014-01-17 17:49:59.000000000 +0100
@@ -68,6 +68,7 @@ usage()
    echo "     ABI=[32|64]          Tell the compiler to use given ABI (default: empty)"
 }
 
+MP="gmp"
 while [ "$1" != "" ]; do
    PARAM=`echo $1 | sed 's/=.*//'`
    VALUE=`echo $1 | sed 's/[^=]*//; s/=//'`
@@ -76,8 +77,13 @@ while [ "$1" != "" ]; do
          usage
          exit 0
          ;;
-      --with-mpir|--with-gmp)
+      --with-gmp)
          GMP_DIR="$VALUE"
+        MP="gmp"
+         ;;
+      --with-mpir)
+         GMP_DIR="$VALUE"
+         MP="mpir"
          ;;
       --with-mpfr)
          MPFR_DIR="$VALUE"
@@ -177,6 +177,9 @@ while [ "$1" != "" ]; do
       CFLAGS)
          CFLAGS="$VALUE"
          ;;
+      LLIBS)
+         LLIBS="$VALUE"
+         ;;
       ABI)
          ABI="$VALUE"
          ;;
@@ -201,7 +207,7 @@ else
 fi
 LIB_DIRS="${LIB_DIRS} ${GMP_LIB_DIR}"
 INC_DIRS="${INC_DIRS} ${GMP_INC_DIR}"
-LIBS="${LIBS} gmp"
+LIBS="${LIBS} ${MP}"
 
 if [ -d "${MPFR_DIR}/lib" ]; then
    MPFR_LIB_DIR="${MPFR_DIR}/lib"
@@ -547,7 +547,4 @@ fi
 CONFIG_PTHREAD="#define HAVE_PTHREAD ${PTHREAD}"
 
-if [ "$PTHREAD" = "1" ]; then
-   LIBS="${LIBS} pthread"
-fi
 
 #pocess external modules
@@ -560,7 +560,7 @@ done
 
 #library paths
 
-LLIBS="-L\$(CURDIR)"
+LLIBS="-L\$(CURDIR) ${LLIBS}"
 for LIB_DIR in ${LIB_DIRS} ${EXTRA_LIB_DIRS}; do
    LLIBS="${LLIBS} -L${LIB_DIR}"
 done
@@ -569,6 +567,9 @@ for LIB_DIR in ${LIB_DIRS} ${EXTRA_LIB_D
 done
 
 #linker params
+if [ "$PTHREAD" = "1" ]; then
+   lLIBS2="-lpthread ${lLIBS2}"
+fi
 
 for LIB in ${EXTRA_LIBS} ${LIBS}; do
    lLIBS2="-l${LIB} ${lLIBS2}"
diff -ur /Users/mike/src/M2-git-linalg/M2/BUILD/mike/builds.tmp/opt64-all/libraries/flint/tmp/flint-2.4/longlong.h flint-2.4/longlong.h
--- /Users/mike/src/M2-git-linalg/M2/BUILD/mike/builds.tmp/opt64-all/libraries/flint/tmp/flint-2.4/longlong.h	2013-12-21 14:59:26.000000000 -0500
+++ flint-2.4/longlong.h	2014-01-06 00:51:03.000000000 -0500
@@ -75,7 +75,7 @@
     mp_limb_t __cbtmp;                                                \
     FLINT_ASSERT ((x) != 0);                                          \
     __asm__ ("bsrq %1,%0" : "=r" (__cbtmp) : "rm" ((mp_limb_t)(x)));  \
-    (count) = __cbtmp ^ (mp_limb_t) 63;                               \
+    (count) = (int)(__cbtmp ^ (mp_limb_t) 63);			      \
   } while (0)
 
 /* bsfq destination must be a 64-bit register, "%q0" forces this in case
diff -ur /Users/mike/src/M2-git-linalg/M2/BUILD/mike/builds.tmp/opt64-all/libraries/flint/tmp/flint-2.4/nmod_poly.h flint-2.4/nmod_poly.h
--- /Users/mike/src/M2-git-linalg/M2/BUILD/mike/builds.tmp/opt64-all/libraries/flint/tmp/flint-2.4/nmod_poly.h	2013-12-21 14:59:26.000000000 -0500
+++ flint-2.4/nmod_poly.h	2014-01-06 01:00:48.000000000 -0500
@@ -343,7 +343,7 @@
     r = flint_printf("%wd %wu", a->length, a->mod.n);
 
     if (a->length == 0)
-        return r;
+      return (int) r;
     else
         if (r > 0)
             r = flint_printf(" ");
